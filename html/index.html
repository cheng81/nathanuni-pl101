<html>
<head>
	<title>MUS playground</title>
	<script type="text/javascript" src="./jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="./jsmidi/midi.js"></script>

	<script src="./jasmid/stream.js"></script>
	<script src="./jasmid/midifile.js"></script>
	<script src="./jasmid/replayer.js"></script>
	<script src="./jasmid/synth.js"></script>
	<script src="./jasmid/audio.js"></script>


	<script type="text/javascript" src="./mus/mus.js"></script>
	<script type="text/javascript" src="./mus/notescompiler.js"></script>

	<script type="text/javascript">
	$(document).ready(function() {
		var require = window.node2browser.require;
		var mus = require('mus');
		$('#play').click(function(e) {
			e.preventDefault();
			var save = $('#save').attr('checked') !== undefined;
			var src = $('#src').val();
			console.log('src',src);
			var notes = mus.make(src);
			var midi = notesToMidi(notes);
			if(midi.b64) {
				console.log('all set!');
				if(save) {
					midi.save();
				} else {
					midiFile = MidiFile(midi.hex);
					synth = Synth(44100);
					replayer = Replayer(midiFile, synth);
					audio = AudioPlayer(replayer);
				}
			}

			return false;
		})
	});
	</script>
</head>

<textarea cols=80 rows=40 id="src">
/*MUS code*/
</textarea>
<br/>
Save <input type="checkbox" id="save" value="save"/>
<br/>
<input type="button" id="play" value="Go!"/>
</html>